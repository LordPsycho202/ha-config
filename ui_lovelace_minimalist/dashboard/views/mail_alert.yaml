title: "Mail Alert"
theme: "minimalist-mobile-tapbar"
icon: mdi:mailbox-open-up-outline
subview: true
path: mailalert
cards:
  - type: custom:stack-in-card
    cards:
      - type: custom:mushroom-template-card
        entity: Mail Delivered
        tap_action:
          action: call-service
          service: input_select.select_option
          target:
            entity_id: input_select.mail_status
          data:
            option: Mail Picked Up
        primary: |
          USPS Mail
        secondary: |-
          {% if states('input_select.mail_status') == "Mail Delivered"%}
            Mail's Here!
            Arrived {{ relative_time(as_datetime(states.input_datetime.mail_delivered.state)) }} ago.
          {% else %} 
            {{ state('input_select.mail_status')}}
          {% endif %}
        icon: |-
          {% if states('input_select.mail_status') == "Mail Delivered"%} mdi:mailbox-open
          {% else %} mdi:mailbox
          {% endif %}
        icon_color: |-
          {% if states('input_select.mail_status') == "Mail Delivered"%} green
          {% else %} white
          {% endif %}
        layout: vertical
        multiline_secondary: true
      - type: conditional
        conditions:
          - entity: input_select.mail_status
            state: "Mail Delivered"
        card:
          show_state: true
          show_name: true
          camera_view: auto
          type: picture-entity
          entity: sensor.mail_usps_mail
          camera_image: camera.mail_usps_camera

  - type: custom:stack-in-card
    cards:
      - type: custom:mushroom-template-card
        entity: input_boolean.package_present
        tap_action:
          action: toggle
        primary: |
          USPS Mail
        secondary: |-
          {% if states('input_boolean.package_present') == "on"%}
            Package's Here!
            Arrived {{ relative_time(as_datetime(states.input_datetime.package_delivered.state)) }} ago.
          {% else %} 
            No Packages
          {% endif %}
        icon: mdi:package
        icon_color: |-
          {% if states('input_boolean.package_present') == "on" %} green
          {% else %} white
          {% endif %}
        layout: vertical
        multiline_secondary: true
      - type: conditional
        conditions:
          - entity: input_boolean.package_present
            state: "on"
        card:
          show_state: true
          show_name: true
          camera_view: auto
          type: picture-entity
          entity: sensor.mail_packages_delivered
          camera_image: camera.aarlo_doorbell
