---
title: "Gardens"
theme: "minimalist-mobile-tapbar"
icon: mdi:greenhouse
path: garden
type: sections
sections:
  - type: grid
    cards:
      - !include /config/ui-includes/alerts.yaml
      - !include ../includes/1-welcome.yaml

      - type: conditional
        conditions:
          - entity: binary_sensor.heat_index_active
            state: "on"
        card:
          type: custom:mushroom-template-card
          primary: >-
            {{ states('sensor.heat_index') | round(1) }}{{
            state_attr('sensor.heat_index','unit_of_measurement') }}
          secondary: Heat Index Warning
          icon: mdi:thermometer-alert
          icon_color: red
          tap_action:
            action: navigate
            navigation_path: weather

      - type: conditional
        conditions:
          - entity: switch.sprinklers
            state: "on"
        card:
          type: custom:mushroom-entity-card
          entity: switch.sprinklers
          icon: mdi:sprinkler-variant
          icon_color: light-blue
          fill_container: false
          tap_action:
            action: none
          hold_action:
            action: more-info
          double_tap_action:
            action: none

      - type: conditional
        conditions:
          - condition: numeric_state
            entity: sensor.monthly_water
            above: 5700
        card:
          type: gauge
          entity: sensor.monthly_water
          unit: gal
          name: Water Usage
          max: 10000
          min: 0
          severity:
            green: 0
            yellow: 5700
            red: 7500

      - type: conditional
        conditions:
          - condition: numeric_state
            entity: counter.days_without_rain
            above: 6
        card:
          type: custom:mushroom-template-card
          primary: >-
            {{ states('counter.days_without_rain') }} {{
            state_attr('counter.days_without_rain','friendly_name') }}
          secondary: >-
            Rain Chance: {{
            state_attr('weather.kwdr_daynight','forecast')[0].precipitation_probability
            }}%
          icon: '{{ state_attr(''counter.days_without_rain'',''icon'') }}'
          entity: counter.days_without_rain
          icon_color: |
            {% if states('counter.days_without_rain')|int > 0 %}
            red
            {% else %}
            blue
            {% endif %}
          tap_action:
            action: navigate
            navigation_path: weather

      - type: conditional
        conditions:
          - entity: lawn_mower.philoctetes
            state: "docked"
        card:
          type: custom:stack-in-card
          cards:
            - type: custom:mushroom-entity-card
              entity: sensor.philoctetes_next_start
              icon: mdi:robot-mower
              icon_color: blue
              tap_action:
                action: more-info
              hold_action:
                action: none
              double_tap_action:
                action: none

      - type: conditional
        conditions:
          - entity: lawn_mower.philoctetes
            state: "error"
        card:
          type: custom:stack-in-card
          cards:
            - type: custom:mushroom-template-card
              primary: "{{ state_attr('lawn_mower.philoctetes','friendly_name')|capitalize }}"
              secondary: "Error: {{ states('sensor.philoctetes_error')|replace('_',' ')|capitalize }}"
              icon: mdi:robot-mower
              icon_color: red
              tap_action:
                action: more-info
              hold_action:
                action: none
              double_tap_action:
                action: none

      - type: conditional
        conditions:
          - condition: or
            conditions:
              - entity: lawn_mower.philoctetes
                state: "mowing"
              - entity: lawn_mower.philoctetes
                state: "returning"
        card:
          type: vertical-stack
          cards:
            - type: map
              entities:
                - entity: device_tracker.philoctetes
              theme_mode: auto
              default_zoom: 19
              auto_fit: true
            - type: "custom:button-card"
              template: card_vacuum
              entity: lawn_mower.philoctetes
  - type: grid
    cards:
      - type: "custom:button-card"
        template: card_title
        name: Indoor Greenhouse
      - type: horizontal-stack
        cards:
          - type: "custom:button-card"
            template: card_light
            entity: light.greenhouse
            variables:
              ulm_card_light_name: Plant Light
              ulm_card_light_force_background_color: true
              ulm_card_light_enable_collapse: true
      - type: custom:button-card
        template: card_navigate
        variables:
          ulm_card_navigate_path: /ui-lovelace-minimalist/plant_timelapse
          ulm_card_navigate_title: Timelapse Views
          ulm_card_navigate_icon: mdi:camera-burst
          ulm_card_navigate_color: var(--color-green)
      - type: custom:stack-in-card
        mode: horizontal
        cards:
          - type: "custom:button-card"
            template: card_graph
            entity: sensor.temp_indoor_greenhouse
            variables:
              ulm_card_graph_color: "var(--google-green)"
              ulm_card_graph_name: Temperature
              ulm_card_graph_entity: sensor.temp_indoor_greenhouse
              ulm_card_graph_type: fill
              ulm_card_graph_hours: 24
          - type: "custom:button-card"
            template: card_graph
            entity: sensor.humidity_indoor_greenhouse
            variables:
              ulm_card_graph_color: "var(--google-blue)"
              ulm_card_graph_name: Humidity
              ulm_card_graph_entity: sensor.humidity_indoor_greenhouse
              ulm_card_graph_type: fill
              ulm_card_graph_hours: 24
      - type: conditional
        conditions:
          - condition: or
            conditions:
              - condition: state
                entity: input_boolean.plant_notify_steve
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_fairy_washboard
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_pitcher_plant
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_seeds
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_michael
                state: "on"
        card:
          type: custom:expander-card
          title-card:
            type: custom:mushroom-template-card
            primary: Indoor Greenhouse
            secondary: |-
              Good:
              {{
                states.plant
                | selectattr('entity_id', 'in', label_entities('indoor_greenhouse'))
                | selectattr('state','in','ok')
                | map(attribute='entity_id')
                | list | count
              }}
              | Needs Attention:
              {{
                states.plant
                | selectattr('entity_id', 'in', label_entities('indoor_greenhouse'))
                | selectattr('state','in','problem')
                | map(attribute='entity_id')
                | list | count
              }}
            icon: mdi:greenhouse
            icon_color: |-
              {%- set problems = states.plant
                | selectattr('entity_id', 'in', label_entities('indoor_greenhouse'))
                | selectattr('state','in','problem')
                | map(attribute='entity_id')
                | list | count %}
              {% if problems | int > 0 %}red{% else %}green{% endif %}
          cards:
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_rose
                  state: "on"
              card:
                type: vertical-stack
                cards:
                  - type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Mini Roses"
                      - plant_entity: plant.rose
                      - plant_path: plant_rose
                      - plant_icon: flower-tulip-outline
                      - plant_moisture_entity: sensor.rose_soil_moisture
                      - plant_moisture_min: number.rose_min_soil_moisture
                      - plant_moisture_max: number.rose_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_steve
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Steve"
                  - plant_entity: plant.steve
                  - plant_path: plant_steve
                  - plant_icon: pine-tree-variant-outline
                  - plant_moisture_entity: sensor.steve_soil_moisture
                  - plant_moisture_min: number.steve_min_soil_moisture
                  - plant_moisture_max: number.steve_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_fairy_washboard
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Fairy Washboard"
                  - plant_entity: plant.fairy_washboard
                  - plant_path: plant_fairy_washboard
                  - plant_icon: grass
                  - plant_moisture_entity: sensor.fairy_washboard_soil_moisture
                  - plant_moisture_min: number.fairy_washboard_min_soil_moisture
                  - plant_moisture_max: number.fairy_washboard_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_seeds
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Seeds"
                  - plant_entity: plant.seeds
                  - plant_path: plant.seeds
                  - plant_moisture_entity: sensor.seeds_soil_moisture
                  - plant_moisture_min: number.seeds_min_soil_moisture
                  - plant_moisture_max: number.seeds_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_michael
                  state: "on"
              card:
                type: vertical-stack
                cards:
                  - type: "custom:button-card"
                    template: card_light
                    entity: light.michael_light_switch
                    variables:
                      ulm_card_light_name: "Michael's Light"
                      ulm_card_light_force_background_color: true
                      ulm_card_light_enable_collapse: true
                  - type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Michael (Office Succulents)"
                      - plant_entity: plant.michael
                      - plant_path: plant_michael
                      - plant_icon: cactus
                      - plant_moisture_entity: sensor.michael_soil_moisture
                      - plant_moisture_min: number.michael_min_soil_moisture
                      - plant_moisture_max: number.michael_max_soil_moisture
  - type: grid
    cards:
      - type: conditional
        conditions:
          - condition: or
            conditions:
              - condition: state
                entity: input_boolean.plant_notify_pineapples
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_blackberries
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_pitcher_plant
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_beans
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_japanese_maple
                state: "on"
        card:
          type: vertical-stack
          cards:
            - type: "custom:button-card"
              template: card_title
              name: Potted Plants
            - type: custom:expander-card
              title-card:
                type: custom:mushroom-template-card
                primary: Potted Plants
                secondary: |-
                  Good:
                  {{
                    states.plant
                    | selectattr('entity_id', 'in', label_entities('potted_plants'))
                    | selectattr('state','in','ok')
                    | map(attribute='entity_id')
                    | list | count
                  }}
                  | Needs Attention:
                  {{
                    states.plant
                    | selectattr('entity_id', 'in', label_entities('potted_plants'))
                    | selectattr('state','in','problem')
                    | map(attribute='entity_id')
                    | list | count
                  }}
                icon: mdi:sprout
                icon_color: |-
                  {%- set problems = states.plant
                    | selectattr('entity_id', 'in', label_entities('potted_plants'))
                    | selectattr('state','in','problem')
                    | map(attribute='entity_id')
                    | list | count %}
                  {% if problems | int > 0 %}red{% else %}green{% endif %}
              cards:
                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_pineapples
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Pineapples"
                      - plant_entity: plant.pineapples
                      - plant_path: plant_pineapple
                      - plant_icon: fruit-pineapple
                      - plant_moisture_entity: sensor.pineapples_soil_moisture
                      - plant_moisture_min: number.pineapples_min_soil_moisture
                      - plant_moisture_max: number.pineapples_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_blackberries
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Blackberries"
                      - plant_entity: plant.blackberries
                      - plant_path: plant_blackberries
                      - plant_icon: fruit-grapes
                      - plant_moisture_entity: sensor.blackberries_soil_moisture
                      - plant_moisture_min: number.blackberries_min_soil_moisture
                      - plant_moisture_max: number.blackberries_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_pitcher_plant
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Pitcher Plant"
                      - plant_entity: plant.pitcher_plant
                      - plant_path: plant_pitcher
                      - plant_moisture_entity: sensor.pitcher_plant_soil_moisture
                      - plant_moisture_min: number.pitcher_plant_min_soil_moisture
                      - plant_moisture_max: number.pitcher_plant_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_beans
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Beans"
                      - plant_entity: plant.beans
                      - plant_path: plant_beans
                      - plant_icon: flower-outline
                      - plant_moisture_entity: sensor.beans_soil_moisture
                      - plant_moisture_min: number.beans_min_soil_moisture
                      - plant_moisture_max: number.beans_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_japanese_maple
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Japanese Maple"
                      - plant_entity: plant.japanese_maple
                      - plant_path: plant_japanese_maple
                      - plant_icon: leaf-maple
                      - plant_moisture_entity: sensor.japanese_maple_soil_moisture
                      - plant_moisture_min: number.japanese_maple_min_soil_moisture
                      - plant_moisture_max: number.japanese_maple_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_hydrangea
                      state: "on"
                  card:
                    type: vertical-stack
                    cards:
                      - type: custom:decluttering-card
                        template: plant_graphs
                        variables:
                          - plant_name: "Hydrangea"
                          - plant_entity: plant.hydrangea
                          - plant_path: plant_hydrangea
                          - plant_icon: flower-outline
                          - plant_moisture_entity: sensor.hydrangea_soil_moisture
                          - plant_moisture_min: number.hydrangea_min_soil_moisture
                          - plant_moisture_max: number.hydrangea_max_soil_moisture
  - type: grid
    cards:
      - type: conditional
        conditions:
          - condition: or
            conditions:
              - condition: state
                entity: input_boolean.plant_notify_front_flowers
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_juniper
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_camellia
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_japanese_holly
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_holly
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_stick
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_lavender
                state: "on"
        card:
          type: vertical-stack
          cards:
            - type: "custom:button-card"
              template: card_title
              name: Front Yard
            - type: horizontal-stack
              cards:
                - type: conditional
                  conditions:
                    - condition: and
                      conditions:
                        - condition: or
                          conditions:
                            - condition: numeric_state
                              entity: sensor.front_flowers_soil_moisture
                              below: 15
                            - condition: numeric_state
                              entity: sensor.juniper_soil_moisture
                              below: 15
                            - condition: numeric_state
                              entity: sensor.camellia_soil_moisture
                              below: 15
                            - condition: numeric_state
                              entity: sensor.japanese_holly_soil_moisture
                              below: 20
                            - condition: numeric_state
                              entity: sensor.holly_soil_moisture
                              below: 20
                            - condition: numeric_state
                              entity: sensor.lavender_soil_moisture
                              below: 15
                        - condition: state
                          entity: timer.flower_bed_watering
                          state: idle
                        - condition: state
                          entity: input_boolean.flower_bed_watering
                          state: "on"
                  card:
                    type: custom:mushroom-template-card
                    primary: Water Flower Beds
                    secondary: >-
                      Last run: {{
                      as_datetime(states('sensor.flower_beds_zone_history')).strftime('%Y.%m.%d
                      %H:%M') }}
                      Hold to start
                    icon: mdi:sprinkler
                    entity: script.flower_bed_watering_2
                    icon_color: grey
                    hold_action:
                      action: call-service
                      service: script.flower_bed_watering_2
                      target: {}
                    double_tap_action:
                      action: none
                    tap_action:
                      action: none
                    multiline_secondary: true
                - type: conditional
                  conditions:
                    - condition: state
                      entity: timer.flower_bed_watering
                      state: active
                  card:
                    type: custom:mushroom-template-card
                    primary: Flower Beds are being Watered
                    secondary: |-
                      {%- set f = state_attr('timer.flower_bed_watering', 'finishes_at') %}
                      Finishes in {{ '00:00:00' if f == None else
                        (as_datetime(f) - now()).total_seconds() | timestamp_custom('%H:%M:%S', false) }}
                      Hold to Stop
                    icon: mdi:sprinkler
                    entity: timer.flower_bed_watering
                    icon_color: blue
                    tap_action:
                      action: none
                    hold_action:
                      action: call-service
                      service: timer.finish
                      target:
                        entity_id: timer.flower_bed_watering
                    double_tap_action:
                      action: none
                    multiline_secondary: true
            - type: custom:expander-card
              title-card:
                type: custom:mushroom-template-card
                primary: Front Yard
                secondary: |-
                  Good:
                  {{
                    states.plant
                    | selectattr('entity_id', 'in', label_entities('frontyard'))
                    | selectattr('state','in','ok')
                    | map(attribute='entity_id')
                    | list | count
                  }}
                  | Needs Attention:
                  {{
                    states.plant
                    | selectattr('entity_id', 'in', label_entities('frontyard'))
                    | selectattr('state','in','problem')
                    | map(attribute='entity_id')
                    | list | count
                  }}
                icon: mdi:nature
                icon_color: |-
                  {%- set problems = states.plant
                    | selectattr('entity_id', 'in', label_entities('frontyard'))
                    | selectattr('state','in','problem')
                    | map(attribute='entity_id')
                    | list | count %}
                  {% if problems | int > 0 %}red{% else %}green{% endif %}
              cards:
                - type: conditional
                  conditions:
                    - condition: or
                      conditions:
                        - condition: state
                          entity: input_boolean.plant_notify_front_flowers
                          state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Front Porch Planter"
                      - plant_entity: plant.front_flowers
                      - plant_path: plant_flowers
                      - plant_icon: flower-outline
                      - plant_moisture_entity: sensor.front_flowers_soil_moisture
                      - plant_moisture_min: number.front_flowers_min_soil_moisture
                      - plant_moisture_max: number.front_flowers_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: or
                      conditions:
                        - condition: state
                          entity: input_boolean.plant_notify_juniper
                          state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Juniper"
                      - plant_entity: plant.juniper
                      - plant_path: plant_juniper
                      - plant_icon: pine-tree-variant-outline
                      - plant_moisture_entity: sensor.juniper_soil_moisture
                      - plant_moisture_min: number.juniper_min_soil_moisture
                      - plant_moisture_max: number.juniper_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_camellia
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Camellia"
                      - plant_entity: plant.camellia
                      - plant_path: plant_camellia
                      - plant_icon: flower
                      - plant_moisture_entity: sensor.camellia_soil_moisture
                      - plant_moisture_min: number.camellia_min_soil_moisture
                      - plant_moisture_max: number.camellia_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_japanese_holly
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Japanese Holly"
                      - plant_entity: plant.japanese_holly
                      - plant_path: plant_japanese_holly
                      - plant_icon: weather-cloudy
                      - plant_moisture_entity: sensor.japanese_holly_soil_moisture
                      - plant_moisture_min: number.japanese_holly_min_soil_moisture
                      - plant_moisture_max: number.japanese_holly_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_holly
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Holly"
                      - plant_entity: plant.holly
                      - plant_path: plant_holly
                      - plant_icon: weather-cloudy
                      - plant_moisture_entity: sensor.holly_soil_moisture
                      - plant_moisture_min: number.holly_min_soil_moisture
                      - plant_moisture_max: number.holly_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_stick
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "The Stick"
                      - plant_entity: plant.stick
                      - plant_path: plant_stick
                      - plant_icon: tree-outline
                      - plant_moisture_entity: sensor.stick_soil_moisture
                      - plant_moisture_min: number.stick_min_soil_moisture
                      - plant_moisture_max: number.stick_max_soil_moisture

                - type: conditional
                  conditions:
                    - condition: state
                      entity: input_boolean.plant_notify_lavender
                      state: "on"
                  card:
                    type: custom:decluttering-card
                    template: plant_graphs
                    variables:
                      - plant_name: "Lavender"
                      - plant_entity: plant.lavender
                      - plant_path: plant_lavender
                      - plant_icon: flower
                      - plant_moisture_entity: sensor.lavender_soil_moisture
                      - plant_moisture_min: number.lavender_min_soil_moisture
                      - plant_moisture_max: number.lavender_max_soil_moisture

  - type: grid
    cards:
      - type: "custom:button-card"
        template: card_title
        name: Backyard Garden
      - type: horizontal-stack
        cards:
          - type: conditional
            conditions:
              - condition: and
                conditions:
                  - condition: or
                    conditions:
                      - condition: numeric_state
                        entity: sensor.okra_soiL_moisture
                        below: 20
                      - condition: numeric_state
                        entity: sensor.bell_pepper_soil_moisture
                        below: 20
                      - condition: numeric_state
                        entity: sensor.herbs_soil_moisture
                        below: 40
                      - condition: numeric_state
                        entity: sensor.cucumber_soil_moisture
                        below: 20
                      - condition: numeric_state
                        entity: sensor.tomatoes_soil_moisture
                        below: 20
                      - condition: numeric_state
                        entity: strawberry_soil_moisture
                        below: 25
                      - condition: numeric_state
                        entity: sensor.onion_soil_moisture
                        below: 15
                      - condition: numeric_state
                        entity: sensor.kale_soil_moisture
                        below: 25
                  - condition: state
                    entity: timer.garden_watering
                    state: idle
                  - condition: state
                    entity: input_boolean.garden_watering
                    state: "on"
            card:
              type: custom:mushroom-template-card
              primary: Water Garden
              secondary: >-
                Last run: {{
                as_datetime(states('sensor.zone_1_zone_history')).strftime('%Y.%m.%d
                %H:%M') }}
                Hold to start
              icon: mdi:sprinkler
              entity: script.garden_watering_2
              icon_color: grey
              hold_action:
                action: call-service
                service: script.garden_watering_2
                target: {}
              double_tap_action:
                action: none
              tap_action:
                action: none
              multiline_secondary: true
          - type: conditional
            conditions:
              - condition: state
                entity: timer.garden_watering
                state: active
            card:
              type: custom:mushroom-template-card
              primary: Garden is being Watered
              secondary: |-
                {%- set f = state_attr('timer.garden_watering', 'finishes_at') %}
                Finishes in {{ '00:00:00' if f == None else
                  (as_datetime(f) - now()).total_seconds() | timestamp_custom('%H:%M:%S', false) }}
                Hold to Stop
              icon: mdi:sprinkler
              entity: timer.garden_watering
              icon_color: blue
              tap_action:
                action: none
              hold_action:
                action: call-service
                service: timer.finish
                target:
                  entity_id: timer.garden_watering
              double_tap_action:
                action: none
              multiline_secondary: true
      - type: custom:stack-in-card
        mode: horizontal
        cards:
          - type: conditional
            conditions:
              - condition: state
                entity: sensor.ecowitt_outdoor_temperature
                state_not: unavailable
            card:
              type: "custom:button-card"
              template: card_graph
              entity: sensor.ecowitt_outdoor_temperature
              variables:
                ulm_card_graph_color: "var(--google-green)"
                ulm_card_graph_name: Air Temp
                ulm_card_graph_entity: sensor.ecowitt_outdoor_temperature
                ulm_card_graph_type: fill
                ulm_card_graph_hours: 24
          - type: "custom:button-card"
            template: card_graph
            entity: sensor.soil_temperature_1
            variables:
              ulm_card_graph_color: "brown"
              ulm_card_graph_name: Soil Temp
              ulm_card_graph_entity: sensor.soil_temperature_1
              ulm_card_graph_type: fill
              ulm_card_graph_hours: 24
      - type: conditional
        conditions:
          - condition: or
            conditions:
              - condition: state
                entity: input_boolean.plant_notify_okra
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_bell_pepper
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_herbs
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_cucumber
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_tomatoes
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_strawberry
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_onions
                state: "on"
              - condition: state
                entity: input_boolean.plant_notify_kale
                state: "on"
        card:
          type: custom:expander-card
          title-card:
            type: custom:mushroom-template-card
            primary: Garden
            secondary: |-
              Good:
              {{
                states.plant
                | selectattr('entity_id', 'in', label_entities('garden'))
                | selectattr('state','in','ok')
                | map(attribute='entity_id')
                | list | count
              }}
              | Needs Attention:
              {{
                states.plant
                | selectattr('entity_id', 'in', label_entities('garden'))
                | selectattr('state','in','problem')
                | map(attribute='entity_id')
                | list | count
              }}
            icon: mdi:land-fields
            icon_color: |-
              {%- set problems = states.plant
                | selectattr('entity_id', 'in', label_entities('garden'))
                | selectattr('state','in','problem')
                | map(attribute='entity_id')
                | list | count %}
              {% if problems | int > 0 %}red{% else %}green{% endif %}
          cards:
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_okra
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Okra"
                  - plant_entity: plant.okra
                  - plant_path: plant_okra
                  - plant_icon: chili-mild
                  - plant_moisture_entity: sensor.okra_soil_moisture
                  - plant_moisture_min: number.okra_min_soil_moisture
                  - plant_moisture_max: number.okra_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_bell_pepper
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Bell Pepper"
                  - plant_entity: plant.bell_pepper
                  - plant_path: plant_bell_pepper
                  - plant_moisture_entity: sensor.bell_pepper_soil_moisture
                  - plant_icon: chili-mild
                  - plant_moisture_min: number.bell_pepper_min_soil_moisture
                  - plant_moisture_max: number.bell_pepper_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_herbs
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Herbs"
                  - plant_entity: plant.herbs
                  - plant_path: plant_herbs
                  - plant_moisture_entity: sensor.herbs_soil_moisture
                  - plant_moisture_min: number.herbs_min_soil_moisture
                  - plant_moisture_max: number.herbs_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_cucumber
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Cucumber"
                  - plant_entity: plant.cucumber
                  - plant_path: plant_cucumber
                  - plant_icon: fruit-pear
                  - plant_moisture_entity: sensor.cucumber_soil_moisture
                  - plant_moisture_min: number.cucumber_min_soil_moisture
                  - plant_moisture_max: number.cucumber_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_tomatoes
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Tomatoes"
                  - plant_entity: plant.tomatoes
                  - plant_path: plant_tomatoes
                  - plant_icon: pig
                  - plant_moisture_entity: sensor.tomatoes_soil_moisture
                  - plant_moisture_min: number.tomatoes_min_soil_moisture
                  - plant_moisture_max: number.tomatoes_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_strawberry
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Strawberries"
                  - plant_entity: plant.strawberry
                  - plant_path: plant_strawberry
                  - plant_moisture_entity: sensor.strawberry_soil_moisture
                  - plant_moisture_min: number.strawberry_min_soil_moisture
                  - plant_moisture_max: number.strawberry_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_onions
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "Onions"
                  - plant_entity: plant.onion
                  - plant_icon: grass
                  - plant_path: plant_onion
                  - plant_moisture_entity: sensor.onion_soil_moisture
                  - plant_moisture_min: number.onion_min_soil_moisture
                  - plant_moisture_max: number.onion_max_soil_moisture
            - type: conditional
              conditions:
                - condition: state
                  entity: input_boolean.plant_notify_kale
                  state: "on"
              card:
                type: custom:decluttering-card
                template: plant_graphs
                variables:
                  - plant_name: "kale"
                  - plant_entity: plant.kale
                  - plant_path: plant_kale
                  - plant_moisture_entity: sensor.kale_soil_moisture
                  - plant_moisture_min: number.kale_min_soil_moisture
                  - plant_moisture_max: number.kale_max_soil_moisture

  - type: grid
    cards:
      - type: "custom:button-card"
        template: card_title
        name: Configurations
      - type: custom:button-card
        template: card_navigate
        variables:
          ulm_card_navigate_path: /ui-lovelace-minimalist/plant_admin
          ulm_card_navigate_title: Garden Admin
          ulm_card_navigate_icon: mdi:cog
          ulm_card_navigate_color: var(--color-red)
